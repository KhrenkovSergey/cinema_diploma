/*! For license information please see admin.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(){n=function(){return r};var t,r={},a=Object.prototype,o=a.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",s=c.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var a=e&&e.prototype instanceof b?e:b,o=Object.create(a.prototype),c=new B(r||[]);return i(o,"_invoke",{value:O(t,n,c)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var p="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function E(){}function w(){}var x={};d(x,l,(function(){return this}));var _=Object.getPrototypeOf,L=_&&_(_(C([])));L&&L!==a&&o.call(L,l)&&(x=L);var k=w.prototype=b.prototype=Object.create(x);function I(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,n){function r(a,i,c,l){var u=h(t[a],t,i);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==e(d)&&o.call(d,"__await")?n.resolve(d.__await).then((function(t){r("next",t,c,l)}),(function(t){r("throw",t,c,l)})):n.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,l)}))}l(u.arg)}var a;i(this,"_invoke",{value:function(t,e){function o(){return new n((function(n,a){r(t,e,n,a)}))}return a=a?a.then(o,o):o()}})}function O(e,n,r){var a=p;return function(o,i){if(a===v)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=T(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var u=h(e,n,r);if("normal"===u.type){if(a=r.done?y:m,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=y,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function C(n){if(n||""===n){var r=n[l];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,i=function e(){for(;++a<n.length;)if(o.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(e(n)+" is not iterable")}return E.prototype=w,i(k,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:E,configurable:!0}),E.displayName=d(w,s,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,d(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},r.awrap=function(t){return{__await:t}},I(S.prototype),d(S.prototype,u,(function(){return this})),r.AsyncIterator=S,r.async=function(t,e,n,a,o){void 0===o&&(o=Promise);var i=new S(f(t,e,n,a),o);return r.isGeneratorFunction(e)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},I(k),d(k,s,"Generator"),d(k,l,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=C,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var l=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;N(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},r}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e,n,r,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(r,a)}function o(t){return i.apply(this,arguments)}function i(){var t;return t=n().mark((function t(e){var a,o,i,c,l,u,s,d,f=arguments;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=f.length>1&&void 0!==f[1]?f[1]:"GET",o=f.length>2&&void 0!==f[2]?f[2]:null,i=!(f.length>3&&void 0!==f[3])||f[3],t.prev=3,c={method:a},i&&(c.credentials="include"),o&&(o instanceof FormData?c.body=o:(l=new FormData,Object.entries(o).forEach((function(t){var e,n,a=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);l=!0);}catch(t){u=!0,a=t}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(e,n)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=a[0],i=a[1];null!=i&&l.append(o,i)})),c.body=l)),console.log("Отправка ".concat(a," запроса к ").concat(e)),t.next=10,fetch("".concat("https://shfe-diplom.neto-server.ru/").concat(e),c);case 10:if((u=t.sent).ok){t.next=31;break}return s="No error body",t.prev=13,t.next=16,u.json();case 16:s=t.sent,t.next=29;break;case 19:return t.prev=19,t.t0=t.catch(13),t.prev=21,t.next=24,u.text();case 24:s=t.sent,t.next=29;break;case 27:t.prev=27,t.t1=t.catch(21);case 29:throw console.error("Server returned an error:",u.status,s),new Error("HTTP error! status: ".concat(u.status));case 31:return t.next=33,u.json();case 33:if(!1!==(d=t.sent).success){t.next=37;break}throw console.error("API operation failed:",d.error),new Error(d.error||"Ошибка API");case 37:return console.log("Получены данные:",d),t.abrupt("return",d);case 41:return t.prev=41,t.t2=t.catch(3),console.error("API Error: ".concat(t.t2.message)),t.abrupt("return",null);case 45:case"end":return t.stop()}}),t,null,[[3,41],[13,19],[21,27]])})),i=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){a(i,r,o,c,l,"next",t)}function l(t){a(i,r,o,c,l,"throw",t)}c(void 0)}))},i.apply(this,arguments)}t.p="/cinema_diploma/";const c=t.p+"1655dd3b8f6ed28ce21d.png";function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function s(){s=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),c=new B(r||[]);return a(i,"_invoke",{value:O(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function b(){}function E(){}function w(){}var x={};d(x,i,(function(){return this}));var _=Object.getPrototypeOf,L=_&&_(_(C([])));L&&L!==n&&r.call(L,i)&&(x=L);var k=w.prototype=b.prototype=Object.create(x);function I(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(a,o,i,c){var u=h(t[a],t,o);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==l(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(d).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return o=o?o.then(a,a):a()}})}function O(e,n,r){var a=p;return function(o,i){if(a===v)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var l=T(c,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var u=h(e,n,r);if("normal"===u.type){if(a=r.done?y:m,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=y,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function B(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function C(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(l(e)+" is not iterable")}return E.prototype=w,a(k,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:E,configurable:!0}),E.displayName=d(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,d(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},I(S.prototype),d(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new S(f(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},I(k),d(k,u,"Generator"),d(k,i,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=C,B.prototype={constructor:B,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(l&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;N(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function d(t,e,n,r,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void n(t)}c.done?e(l):Promise.resolve(l).then(r,a)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){d(o,r,a,i,c,"next",t)}function c(t){d(o,r,a,i,c,"throw",t)}i(void 0)}))}}"true"!==localStorage.getItem("adminAuth")&&(alert("Необходимо авторизоваться для доступа к этой странице."),window.location.href="login.html"),document.addEventListener("DOMContentLoaded",(function(){var t=[],e=[],n=[],r=document.getElementById("halls-list"),a=document.getElementById("add-hall-modal"),i=document.getElementById("add-hall-btn"),l=document.getElementById("add-hall-form"),d=document.getElementById("close-add-hall"),h=document.getElementById("cancel-add-hall"),p=document.getElementById("draggable-films-container"),m=document.getElementById("seance-grid-container"),v=document.getElementById("add-film-btn"),y=document.getElementById("add-film-modal"),g=document.getElementById("add-film-form"),b=document.getElementById("close-add-film-modal"),E=document.getElementById("cancel-add-film"),w=document.getElementById("film-poster-input"),x=document.getElementById("poster-file-name"),_=["#c8e6c9","#fff9c4","#ffcdd2","#d1c4e9","#b2ebf2","#f8bbd0","#e1bee7","#bbdefb","#d7ccc8","#ffe0b2","#ffccbc","#bcaaa4"],L=document.getElementById("hall-config-form"),k=document.getElementById("hall-config-select"),I=document.getElementById("hall-config-grid"),S=document.getElementById("rows-count"),O=document.getElementById("seats-count"),T=document.getElementById("price-config-form"),j=document.getElementById("price-config-select"),N=document.getElementById("standart-price"),B=document.getElementById("vip-price"),C=document.getElementById("open-sales-form"),P=document.getElementById("sales-hall-select"),A=C?C.querySelector('button[type="submit"]'):null,M=null,D=1440;function G(){r&&(r.innerHTML=t.map((function(t){return'\n            <div class="hall-item">\n              <span>'.concat(t.hall_name,'</span>\n              <a href="#" class="btn-reset delete-hall-btn" data-hall-id="').concat(t.id,'" aria-label="Удалить зал">\n                <img src="').concat(c,'" alt="Удалить зал">\n              </a>\n            </div>\n        ')})).join("")||"<p>Залов пока нет. Создайте первый!</p>",[k,j,P,document.getElementById("seance-hall")].forEach((function(e){if(e){var n=e.value;e.innerHTML="<option selected disabled>Выберите зал</option>",t.forEach((function(t){e.innerHTML+='<option value="'.concat(t.id,'">').concat(t.hall_name,"</option>")})),t.some((function(t){return t.id==n}))&&(e.value=n)}}))),p&&(p.innerHTML="",e.forEach((function(t,e){var n=document.createElement("div");n.className="film-item-draggable",n.style.backgroundColor=_[e%_.length],n.innerHTML='\n                <div class="dnd-film-item__poster-wrapper">\n                    <div class="dnd-film-item__poster" style="background-image: url('.concat(t.film_poster,');"></div>\n                </div>\n                <div class="film-item-draggable__info">\n                    <h5 class="film-item-draggable__title">').concat(t.film_name,'</h5>\n                    <p class="film-item-draggable__duration">').concat(t.film_duration,' мин.</p>\n                </div>\n                 <a href="#" class="btn-reset delete-film-btn" data-film-id="').concat(t.id,'" aria-label="Удалить фильм">\n                    <img src="').concat(c,'" alt="Удалить фильм">\n                 </a>\n            '),p.appendChild(n)}))),function(){if(m){m.innerHTML="<h5>Сетка сеансов</h5>";var r=document.createElement("ul");n.forEach((function(n){var a=e.find((function(t){return t.id===n.seance_filmid})),o=t.find((function(t){return t.id===n.seance_hallid}));if(a&&o){var i=document.createElement("li");i.textContent='Фильм "'.concat(a.film_name,'" в зале "').concat(o.hall_name,'" в ').concat(n.seance_time),r.appendChild(i)}})),0===n.length?m.innerHTML+="<p>Сеансов пока нет.</p>":m.appendChild(r)}}()}function H(){return F.apply(this,arguments)}function F(){return(F=f(s().mark((function a(){var i;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,o("alldata");case 3:if(!(i=a.sent)||!i.success){a.next=12;break}t=i.result.halls||[],e=i.result.films||[],n=i.result.seances||[],G(),$(),a.next=13;break;case 12:throw new Error("Не удалось получить данные с сервера");case 13:a.next=19;break;case 15:a.prev=15,a.t0=a.catch(0),r&&(r.innerHTML='<p class="text-danger">'.concat(a.t0.message,"</p>")),console.error(a.t0);case 19:case"end":return a.stop()}}),a,null,[[0,15]])})))).apply(this,arguments)}i&&i.addEventListener("click",(function(){return a.classList.remove("hidden")})),d&&d.addEventListener("click",(function(){return a.classList.add("hidden")})),h&&h.addEventListener("click",(function(){return a.classList.add("hidden")})),l&&l.addEventListener("submit",function(){var t=f(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),n=l.querySelector('[name="hallName"]').value.trim()){t.next=4;break}return t.abrupt("return",alert("Название зала не может быть пустым."));case 4:return t.prev=4,t.next=7,o("hall","POST",{hallName:n});case 7:return a.classList.add("hidden"),l.reset(),t.next=11,H();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),alert(t.t0.message||"Произошла ошибка при добавлении зала.");case 16:case"end":return t.stop()}}),t,null,[[4,13]])})));return function(e){return t.apply(this,arguments)}}()),r&&r.addEventListener("click",function(){var t=f(s().mark((function t(e){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.target.closest(".delete-hall-btn"))){t.next=15;break}if(e.preventDefault(),r=n.dataset.hallId,!confirm("Вы уверены, что хотите удалить этот зал? Это действие необратимо.")){t.next=15;break}return t.prev=5,t.next=8,o("hall/".concat(r),"DELETE");case 8:return t.next=10,H();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(5),alert(t.t0.message||"Не удалось удалить зал.");case 15:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(e){return t.apply(this,arguments)}}()),v&&v.addEventListener("click",(function(){return y.classList.remove("hidden")})),b&&b.addEventListener("click",(function(){return y.classList.add("hidden")})),E&&E.addEventListener("click",(function(){return y.classList.add("hidden")})),w&&w.addEventListener("change",(function(){w.files.length>0?x.textContent=w.files[0].name:x.textContent="Файл не выбран"})),g&&g.addEventListener("submit",function(){var t=f(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),(n=new FormData).append("filmName",document.getElementById("film-title-input").value),n.append("filmDuration",document.getElementById("film-duration-input").value),n.append("filmDescription",document.getElementById("film-description-input").value),n.append("filmOrigin",document.getElementById("film-origin-input").value),w.files[0]&&n.append("filePoster",w.files[0]),t.prev=7,t.next=10,o("film","POST",n);case 10:return y.classList.add("hidden"),g.reset(),x.textContent="Файл не выбран",t.next=15,H();case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(7),alert(t.t0.message||"Произошла ошибка при добавлении фильма.");case 20:case"end":return t.stop()}}),t,null,[[7,17]])})));return function(e){return t.apply(this,arguments)}}());var q=null;function Y(){if(I){var t=parseInt(S.value,10)||0,e=parseInt(O.value,10)||0,n=q?q.hall_config:[];I.innerHTML="";for(var r=0;r<t;r++){var a=document.createElement("div");a.className="hall-config__row";for(var o=0;o<e;o++){var i=document.createElement("div"),c=n&&n[r]&&n[r][o]?n[r][o]:"standart";i.className="hall-config__seat hall-config__seat--".concat(c),a.appendChild(i)}I.appendChild(a)}}}k&&k.addEventListener("change",(function(){(q=t.find((function(t){return t.id==k.value})))&&(S.value=q.hall_rows,O.value=q.hall_places,Y())})),[S,O].forEach((function(t){t&&t.addEventListener("input",(function(){q?Y():(alert("Сначала выберите зал, чтобы менять его размеры."),S.value="",O.value="")}))})),I&&I.addEventListener("click",(function(t){if(t.target.matches(".hall-config__seat")){var e=t.target.classList;e.contains("hall-config__seat--standart")?e.replace("hall-config__seat--standart","hall-config__seat--vip"):e.contains("hall-config__seat--vip")?e.replace("hall-config__seat--vip","hall-config__seat--disabled"):e.replace("hall-config__seat--disabled","hall-config__seat--standart")}})),L&&L.addEventListener("submit",function(){var t=f(s().mark((function t(e){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),q){t.next=3;break}return t.abrupt("return",alert("Сначала выберите зал для конфигурации."));case 3:return n=Array.from(I.querySelectorAll(".hall-config__row")).map((function(t){return Array.from(t.querySelectorAll(".hall-config__seat")).map((function(t){return t.classList.contains("hall-config__seat--vip")?"vip":t.classList.contains("hall-config__seat--disabled")?"disabled":"standart"}))})),r={rowCount:S.value,placeCount:O.value,config:JSON.stringify(n)},t.prev=5,t.next=8,o("hall/".concat(q.id),"POST",r);case 8:return alert("Конфигурация зала успешно сохранена!"),t.next=11,H();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),alert(t.t0.message||"Ошибка сохранения конфигурации зала.");case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}());var U=null;j&&j.addEventListener("change",(function(){(U=t.find((function(t){return t.id==j.value})))&&(N.value=U.hall_price_standart,B.value=U.hall_price_vip)})),T&&T.addEventListener("submit",function(){var t=f(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),U){t.next=3;break}return t.abrupt("return",alert("Сначала выберите зал для конфигурации цен."));case 3:return n={priceStandart:N.value,priceVip:B.value},t.prev=4,t.next=7,o("price/".concat(U.id),"POST",n);case 7:return alert("Цены успешно сохранены!"),t.next=10,H();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),alert(t.t0.message||"Ошибка сохранения цен.");case 15:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}());var R=null;function $(){var r=document.getElementById("dnd-films-list"),a=document.getElementById("dnd-timelines");r&&a&&(r.innerHTML="",r.className="",e.forEach((function(t,e){var n=document.createElement("div");n.className="dnd-film-item",n.draggable=!0,n.dataset.filmId=t.id,n.dataset.duration=t.film_duration;var a=_[e%_.length];n.style.backgroundColor=a;var o=document.createElement("img");o.className="dnd-film-item__poster",o.alt=t.film_name;try{o.src=t.film_poster}catch(e){console.error("Invalid poster URL: ".concat(t.film_poster))}var i=document.createElement("div");i.className="dnd-film-item__info",i.innerHTML='\n                <h5 class="dnd-film-item__title">'.concat(t.film_name,'</h5>\n                <p class="dnd-film-item__duration">').concat(t.film_duration," мин.</p>\n            ");var l=document.createElement("a");l.href="#",l.className="btn-reset delete-film-btn",l.dataset.filmId=t.id,l.setAttribute("aria-label","Удалить фильм"),l.innerHTML='<img src="'.concat(c,'" alt="Удалить фильм">'),n.appendChild(o),n.appendChild(i),n.appendChild(l),r.appendChild(n)})),a.innerHTML="",t.forEach((function(t){var r=document.createElement("div");r.className="dnd-hall-block",r.innerHTML='<h5 class="dnd-hall-block__title">'.concat(t.hall_name,"</h5>");var o=document.createElement("div");o.className="dnd-timeline-wrapper";var i=document.createElement("div");i.className="dnd-timeline",i.dataset.hallId=t.id,n.filter((function(e){return e.seance_hallid===t.id})).forEach((function(t){var n,r,a=e.find((function(e){return e.id===t.seance_filmid}));if(a){var o=a.film_duration,c=(n=t.seance_time.split(":").map(Number),r=2,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,o,i,c=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);l=!0);}catch(t){u=!0,a=t}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}(n,r)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=60*c[0]+c[1],s=document.createElement("div");s.className="dnd-seance",s.draggable=!0,s.dataset.seanceId=t.id,s.dataset.filmId=a.id;var d=e.findIndex((function(t){return t.id===a.id})),f=_[d%_.length];s.style.backgroundColor=f,s.style.left="".concat(l/D*100,"%"),s.style.width="".concat(o/D*100,"%"),s.innerHTML='\n                    <p class="dnd-seance__title">'.concat(a.film_name,'</p>\n                    <button class="btn-reset dnd-seance__delete" data-seance-id="').concat(t.id,'">&times;</button>\n                '),i.appendChild(s)}}));var c=document.createElement("div");c.className="dnd-timeline-scale";for(var l=0;l<24;l++){var s=document.createElement("div");s.className="dnd-timeline-scale__hour",l%2==0&&l>0&&(s.textContent="".concat(String(l).padStart(2,"0"),":00")),c.appendChild(s)}o.appendChild(i),o.appendChild(c),r.appendChild(o),a.appendChild(r)})))}P&&P.addEventListener("change",(function(){R=t.find((function(t){return t.id==P.value})),function(){if(A)if(R){var t=1===Number(R.hall_open);A.textContent=t?"Приостановить продажу билетов":"Открыть продажу билетов",A.classList.toggle("btn-danger",t),A.classList.toggle("btn-primary",!t),A.disabled=!1}else A.textContent="Выберите зал",A.disabled=!0}()})),C&&C.addEventListener("submit",function(){var t=f(s().mark((function t(e){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),R){t.next=3;break}return t.abrupt("return",alert("Сначала выберите зал."));case 3:return n={hallOpen:1===Number(R.hall_open)?"0":"1"},t.prev=4,t.next=7,o("open/".concat(R.id),"POST",n);case 7:return alert("Статус продаж успешно изменен!"),t.next=10,H();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),alert(t.t0.message||"Ошибка изменения статуса продаж.");case 15:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}());var J=document.getElementById("dnd-films-list"),V=document.getElementById("dnd-timelines");J&&(J.addEventListener("dragstart",(function(t){t.target.classList.contains("dnd-film-item")&&(M=t.target)})),J.addEventListener("click",function(){var t=f(s().mark((function t(e){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.target.closest(".delete-film-btn"))){t.next=15;break}if(e.preventDefault(),r=n.dataset.filmId,!confirm("Вы уверены, что хотите удалить этот фильм? Все сеансы с этим фильмом также будут удалены.")){t.next=15;break}return t.prev=5,t.next=8,o("film/".concat(r),"DELETE");case 8:return t.next=10,H();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(5),alert(t.t0.message||"Не удалось удалить фильм.");case 15:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(e){return t.apply(this,arguments)}}())),V&&(V.addEventListener("dragstart",(function(t){t.target.classList.contains("dnd-seance")&&(M=t.target)})),V.addEventListener("dragover",(function(t){t.preventDefault()})),V.addEventListener("drop",function(){var t=f(s().mark((function t(e){var n,r,a,i,c,l,u,d,f;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),(n=e.target.closest(".dnd-timeline"))&&M){t.next=4;break}return t.abrupt("return");case 4:if(r=n.dataset.hallId,a=n.getBoundingClientRect(),i=e.clientX-a.left,c=Math.round(i/a.width*D),l=Math.floor(c/60),u=c%60,d="".concat(String(l).padStart(2,"0"),":").concat(String(u).padStart(2,"0")),f=M.dataset.filmId,!M.classList.contains("dnd-film-item")){t.next=23;break}return t.prev=13,t.next=16,o("seance","POST",{seanceHallid:r,seanceFilmid:f,seanceTime:d});case 16:return t.next=18,H();case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(13),alert(t.t0.message||"Ошибка добавления сеанса");case 23:M=null;case 24:case"end":return t.stop()}}),t,null,[[13,20]])})));return function(e){return t.apply(this,arguments)}}()),V.addEventListener("click",function(){var t=f(s().mark((function t(e){var n,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.target.closest(".dnd-seance__delete"))){t.next=14;break}if(r=n.dataset.seanceId,!confirm("Удалить этот этот сеанс?")){t.next=14;break}return t.prev=4,t.next=7,o("seance/".concat(r),"DELETE");case 7:return t.next=9,H();case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),alert(t.t0.message||"Не удалось удалить сеанс.");case 14:case"end":return t.stop()}}),t,null,[[4,11]])})));return function(e){return t.apply(this,arguments)}}())),H()}))})();